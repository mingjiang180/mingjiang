name: Test Docker-in-Docker (Build Only)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: arc-runner-set20

    steps:
      - name: ğŸ§ª Check Docker Connectivity
        run: docker --tlscacert="" version

      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4
        # æ­¤æ—¶ä»“åº“ä¸­çš„ Dockerfile å·²å¯ç”¨

      - name: ğŸ—ï¸ Build Docker Image
        run: |
          IMAGE_NAME=test-dind:${GITHUB_SHA::8}
          docker --tlscacert="" build -t $IMAGE_NAME .

      - name: ğŸ” Verify Image
        run: docker --tlscacert="" images | grep test-dind

      - name: ğŸ§¹ Cleanup
        if: always()
        run: docker --tlscacert="" system prune -af
